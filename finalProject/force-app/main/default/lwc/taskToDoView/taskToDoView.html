<template>
   
    <lightning-card
        title="My tasks"
        icon-name="custom:custom63"
    >
        <div class="slds-var-m-around_medium">
            <lightning-accordion allow-multiple-sections-open>
                <template for:each={tasks} for:item="task">
                    <lightning-accordion-section class={task.RecordType.Name} name={task.Name} key={task.Id} label={task.Name}>
                        <div class="info-block slds-grid slds-wrap">
                            <div class="slds-col slds-size_6-of-12">
                                <lightning-icon icon-name="custom:custom11" alternative-text="FinishDate" title="FinishDate"></lightning-icon>
                                <template if:true={task.CreatedDate}>
                                    Start Date: <span>
                                        <lightning-formatted-date-time value={task.CreatedDate} year="numeric" 
                                            month="numeric" day="numeric" hour="2-digit" minute="2-digit"
                                                time-zone="UTC" time-zone-name="short" hour12="false"></lightning-formatted-date-time>
                                        </span>
                                </template>
                                <template if:false={task.CreatedDate}>
                                    Start Date: <span>Date not set</span>
                                </template>
                            </div>

                            <div class="slds-col slds-size_6-of-12">
                                <lightning-icon icon-name="custom:custom53" alternative-text="Deadline" title="Deadline"></lightning-icon>
                                <template if:true={task.Deadline_Date__c}>
                                    Deadline Date: <span>
                                                        <lightning-formatted-date-time value={task.Deadline_Date__c} year="numeric" 
                                                            month="numeric" day="numeric" hour="2-digit" minute="2-digit"
                                                                time-zone="UTC" time-zone-name="short" hour12="false"></lightning-formatted-date-time>
                                                    </span>
                                </template>
                                <template if:false={task.Deadline_Date__c}>
                                    Deadline Date: <span>Date not set</span>
                                </template>
                            </div>    
                        </div>

                        <div class="info-block slds-grid slds-wrap">
                            <div class="slds-col slds-size_6-of-12">
                                <lightning-icon icon-name="custom:custom48" alternative-text="FinishDate" title="FinishDate"></lightning-icon>
                                <template if:true={task.Finish_Date__c}>
                                    Finish Date: <span>
                                        <p><lightning-formatted-date-time value={task.Finish_Date__c} year="numeric" 
                                            month="numeric" day="numeric" hour="2-digit" minute="2-digit"
                                                time-zone="UTC" time-zone-name="short" hour12="false"></lightning-formatted-date-time></p>
                                        </span>
                                </template>
                                <template if:false={task.Finish_Date__c}>
                                    Finish Date: <span>Date not set</span>
                                </template>
                            </div>
                            <div class="slds-col slds-size_6-of-12">
                                Status: <span>{task.Status__c}</span>
                            </div>
                        </div>

                        <div class="info-block slds-grid slds-wrap">
                            <div class="slds-col slds-size_6-of-12">
                                <template if:true={task.Description__c}>
                                    Description: <span>{task.Description__c}</span>
                                </template>
                                <template if:false={task.Description__c}>
                                    Description: <span>Description not set</span>
                                </template>
                            </div>    
                            <div class="slds-col slds-size_6-of-12">
                                <lightning-button-icon 
                                label='edit'
                                icon-name="utility:edit"
                                onclick={showTaskEditWindow}
                                ></lightning-button-icon>

                                <c-edit-task-window
                                show-edit-task-window={showEditTaskWindow} 
                                show-positive={showPositiveButton}
                                positive-button-label={positiveButtonLabel} 
                                show-negative={showNegativeButton}
                                onpositive={closeTaskEditWindow}
                                onclose={closeTaskEditWindow}
                                task-todo-obj={task}/>
                                </c-edit-task-window> 
                            </div>
                        </div>

                        <c-sub-task-list task={task} onrefreshalert={refreshApexCode}> 
                        </c-sub-task-list>
                        
                    </lightning-accordion-section>
                   
                </template>
                <c-pagination  onprevious={previousHandler2} onnext={nextHandler2} onselected={changeHandler2} onfirstpage={firstpagehandler} onlastpage={lastpagehandler}></c-pagination>

                <template if:true={error}>
                    <p>{error}</p>>
                </template>
             
            </lightning-accordion>
        </div>
    </lightning-card> 

    

</template>